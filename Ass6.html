<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scientific Calculator</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: #1f1f1f;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  padding: 20px;
}

.calculator-container {
  background: #2a2a2a;
  padding: 25px;
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
  width: 100%;
  max-width: 420px;
  border: 1px solid #3a3a3a;
  animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.calculator-header {
  text-align: center;
  margin-bottom: 20px;
}

.calculator-header h2 {
  color: #ffffff;
  font-size: 1.5rem;
  font-weight: 600;
}

.display-container {
  background: #1f1f1f;
  border-radius: 15px;
  padding: 20px;
  margin-bottom: 20px;
  border: 2px solid #3a3a3a;
  min-height: 100px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.display-history {
  color: #888888;
  font-size: 0.9rem;
  min-height: 20px;
  text-align: right;
  word-wrap: break-word;
  margin-bottom: 10px;
}

.display-main {
  color: #ffffff;
  font-size: 2rem;
  text-align: right;
  word-wrap: break-word;
  word-break: break-all;
  font-weight: 500;
  min-height: 40px;
  overflow-x: auto;
  overflow-y: hidden;
}

.mode-toggle {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}

.mode-btn {
  flex: 1;
  padding: 10px;
  border: 2px solid #3a3a3a;
  background: #1f1f1f;
  color: #aaaaaa;
  border-radius: 8px;
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: 600;
  transition: all 0.3s ease;
}

.mode-btn.active {
  background: #555555;
  color: #ffffff;
  border-color: #555555;
}

.mode-btn:hover {
  background: #333333;
}

.buttons-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 10px;
}

.btn {
  padding: 18px;
  border: none;
  border-radius: 10px;
  font-size: 1.1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  color: #ffffff;
  background: #333333;
  border: 1px solid #3a3a3a;
  user-select: none;
}

.btn:hover {
  background: #444444;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.btn:active {
  transform: scale(0.95);
}

.btn-operator {
  background: #555555;
  color: #ffffff;
}

.btn-operator:hover {
  background: #666666;
}

.btn-function {
  background: #3a3a3a;
  color: #aaaaaa;
  font-size: 0.95rem;
}

.btn-function:hover {
  background: #444444;
  color: #ffffff;
}

.btn-clear {
  background: #d32f2f;
  color: #ffffff;
}

.btn-clear:hover {
  background: #e53935;
}

.btn-equals {
  background: #4CAF50;
  color: #ffffff;
  grid-column: span 2;
}

.btn-equals:hover {
  background: #5cb85c;
}

.btn-zero {
  grid-column: span 2;
}

/* Responsive Design */
@media (max-width: 768px) {
  .calculator-container {
    max-width: 100%;
    padding: 20px;
  }

  .display-main {
    font-size: 1.8rem;
  }

  .btn {
    padding: 15px 10px;
    font-size: 1rem;
  }

  .btn-function {
    font-size: 0.8rem;
  }
}

@media (max-width: 480px) {
  body {
    padding: 10px;
    align-items: flex-start;
  }

  .calculator-container {
    padding: 15px;
    max-width: 100%;
  }

  .calculator-header h2 {
    font-size: 1.2rem;
  }

  .display-container {
    padding: 12px;
    min-height: 80px;
  }

  .display-main {
    font-size: 1.4rem;
  }

  .display-history {
    font-size: 0.75rem;
  }

  .buttons-grid {
    gap: 6px;
  }

  .btn {
    padding: 12px 6px;
    font-size: 0.85rem;
    min-height: 45px;
  }

  .btn-function {
    font-size: 0.7rem;
    padding: 10px 4px;
  }

  .mode-btn {
    padding: 8px;
    font-size: 0.8rem;
  }

  .mode-toggle {
    gap: 8px;
    margin-bottom: 12px;
  }
}

@media (max-width: 380px) {
  .calculator-container {
    padding: 12px;
  }

  .buttons-grid {
    gap: 5px;
  }

  .btn {
    padding: 10px 4px;
    font-size: 0.8rem;
    min-height: 42px;
  }

  .btn-function {
    font-size: 0.65rem;
    padding: 8px 3px;
  }

  .display-main {
    font-size: 1.3rem;
  }

  .display-container {
    padding: 10px;
  }
}

@media (max-width: 360px) {
  .calculator-container {
    padding: 10px;
  }

  .calculator-header h2 {
    font-size: 1.1rem;
    margin-bottom: 10px;
  }

  .btn {
    padding: 9px 3px;
    font-size: 0.75rem;
    min-height: 40px;
  }

  .btn-function {
    font-size: 0.6rem;
  }

  .display-main {
    font-size: 1.2rem;
  }

  .mode-toggle {
    margin-bottom: 10px;
  }
}

@media (max-width: 320px) {
  .calculator-container {
    padding: 8px;
  }

  .buttons-grid {
    gap: 4px;
  }

  .btn {
    padding: 8px 2px;
    font-size: 0.7rem;
    min-height: 38px;
  }

  .btn-function {
    font-size: 0.55rem;
  }

  .display-main {
    font-size: 1.1rem;
  }

  .display-container {
    padding: 8px;
    min-height: 70px;
  }

  .mode-btn {
    padding: 6px;
    font-size: 0.75rem;
  }
}
</style>
</head>
<body>
<div class="calculator-container">
  <div class="calculator-header">
    <h2>Scientific Calculator</h2>
  </div>

  <div class="display-container">
    <div class="display-history" id="history"></div>
    <div class="display-main" id="display">0</div>
  </div>

  <div class="mode-toggle">
    <button class="mode-btn active" id="degBtn" onclick="setMode('deg')">DEG</button>
    <button class="mode-btn" id="radBtn" onclick="setMode('rad')">RAD</button>
  </div>

  <div class="buttons-grid">
    <!-- Row 1 - Functions -->
    <button class="btn btn-function" onclick="appendFunction('sin(')">sin</button>
    <button class="btn btn-function" onclick="appendFunction('cos(')">cos</button>
    <button class="btn btn-function" onclick="appendFunction('tan(')">tan</button>
    <button class="btn btn-function" onclick="appendFunction('log(')">log</button>
    <button class="btn btn-function" onclick="appendFunction('ln(')">ln</button>

    <!-- Row 2 - Functions -->
    <button class="btn btn-function" onclick="appendFunction('sqrt(')">√</button>
    <button class="btn btn-function" onclick="appendToDisplay('^')">x^y</button>
    <button class="btn btn-function" onclick="appendToDisplay('**2')">x²</button>
    <button class="btn btn-function" onclick="appendFunction('1/')">1/x</button>
    <button class="btn btn-function" onclick="appendToDisplay('%')">%</button>

    <!-- Row 3 -->
    <button class="btn btn-clear" onclick="clearDisplay()">C</button>
    <button class="btn btn-operator" onclick="appendToDisplay('(')">(</button>
    <button class="btn btn-operator" onclick="appendToDisplay(')')">)</button>
    <button class="btn btn-operator" onclick="deleteChar()">⌫</button>
    <button class="btn btn-operator" onclick="appendToDisplay('/')">÷</button>

    <!-- Row 4 -->
    <button class="btn" onclick="appendToDisplay('7')">7</button>
    <button class="btn" onclick="appendToDisplay('8')">8</button>
    <button class="btn" onclick="appendToDisplay('9')">9</button>
    <button class="btn btn-operator" onclick="appendToDisplay('*')">×</button>
    <button class="btn btn-function" onclick="appendToDisplay('Math.PI')">π</button>

    <!-- Row 5 -->
    <button class="btn" onclick="appendToDisplay('4')">4</button>
    <button class="btn" onclick="appendToDisplay('5')">5</button>
    <button class="btn" onclick="appendToDisplay('6')">6</button>
    <button class="btn btn-operator" onclick="appendToDisplay('-')">−</button>
    <button class="btn btn-function" onclick="appendToDisplay('Math.E')">e</button>

    <!-- Row 6 -->
    <button class="btn" onclick="appendToDisplay('1')">1</button>
    <button class="btn" onclick="appendToDisplay('2')">2</button>
    <button class="btn" onclick="appendToDisplay('3')">3</button>
    <button class="btn btn-operator" onclick="appendToDisplay('+')">+</button>
    <button class="btn btn-function" onclick="factorial()">n!</button>

    <!-- Row 7 -->
    <button class="btn btn-zero" onclick="appendToDisplay('0')">0</button>
    <button class="btn" onclick="appendToDisplay('.')">.</button>
    <button class="btn btn-equals" onclick="calculate()">=</button>
  </div>
</div>

<script>
let display = document.getElementById('display');
let history = document.getElementById('history');
let currentInput = '0';
let angleMode = 'deg'; // deg or rad
let lastResult = null;

function setMode(mode) {
  angleMode = mode;
  document.getElementById('degBtn').classList.toggle('active', mode === 'deg');
  document.getElementById('radBtn').classList.toggle('active', mode === 'rad');
}

function appendToDisplay(value) {
  if (currentInput === '0' || currentInput === 'Error') {
    currentInput = value;
  } else {
    currentInput += value;
  }
  updateDisplay();
}

function appendFunction(func) {
  // Special handling for 1/x
  if (func === '1/') {
    if (currentInput === '0' || currentInput === 'Error') {
      currentInput = '1/';
    } else {
      // Wrap current input in 1/()
      currentInput = '1/(' + currentInput + ')';
    }
  } else {
    if (currentInput === '0' || currentInput === 'Error') {
      currentInput = func;
    } else {
      currentInput += func;
    }
  }
  updateDisplay();
}

function updateDisplay() {
  display.textContent = currentInput;
}

function clearDisplay() {
  currentInput = '0';
  history.textContent = '';
  updateDisplay();
}

function deleteChar() {
  if (currentInput.length > 1) {
    currentInput = currentInput.slice(0, -1);
  } else {
    currentInput = '0';
  }
  updateDisplay();
}

function factorial() {
  try {
    let num = parseFloat(currentInput);
    if (num < 0 || !Number.isInteger(num)) {
      throw new Error('Invalid input');
    }
    let result = 1;
    for (let i = 2; i <= num; i++) {
      result *= i;
    }
    history.textContent = currentInput + '!';
    currentInput = result.toString();
    updateDisplay();
  } catch (e) {
    currentInput = 'Error';
    updateDisplay();
  }
}

function toRadians(degrees) {
  return degrees * (Math.PI / 180);
}

function calculate() {
  try {
    history.textContent = currentInput;
    
    // Replace display notation with JavaScript
    let expression = currentInput
      .replace(/sin\(/g, angleMode === 'deg' ? 'Math.sin(toRadians(' : 'Math.sin(')
      .replace(/cos\(/g, angleMode === 'deg' ? 'Math.cos(toRadians(' : 'Math.cos(')
      .replace(/tan\(/g, angleMode === 'deg' ? 'Math.tan(toRadians(' : 'Math.tan(')
      .replace(/log\(/g, 'Math.log10(')
      .replace(/ln\(/g, 'Math.log(')
      .replace(/sqrt\(/g, 'Math.sqrt(')
      .replace(/\^/g, '**')
      .replace(/×/g, '*')
      .replace(/÷/g, '/')
      .replace(/−/g, '-');
    
    // Add closing parentheses for trig functions in deg mode
    if (angleMode === 'deg') {
      expression = expression.replace(/(Math\.(sin|cos|tan)\(toRadians\([^)]+)\)/g, '$1))');
    }
    
    // Evaluate the expression
    let result = eval(expression);
    
    // Handle special cases
    if (isNaN(result) || !isFinite(result)) {
      throw new Error('Math Error');
    }
    
    // Round to avoid floating point errors
    result = Math.round(result * 1000000000) / 1000000000;
    
    currentInput = result.toString();
    lastResult = result;
    updateDisplay();
  } catch (e) {
    currentInput = 'Error';
    updateDisplay();
    setTimeout(() => {
      currentInput = '0';
      updateDisplay();
    }, 1500);
  }
}

function toRadians(degrees) {
  return degrees * (Math.PI / 180);
}

// Keyboard support
document.addEventListener('keydown', function(e) {
  const key = e.key;
  
  if (key >= '0' && key <= '9') {
    appendToDisplay(key);
  } else if (key === '.') {
    appendToDisplay('.');
  } else if (key === '+' || key === '-' || key === '*' || key === '/') {
    appendToDisplay(key);
  } else if (key === 'Enter' || key === '=') {
    e.preventDefault();
    calculate();
  } else if (key === 'Escape' || key === 'c' || key === 'C') {
    clearDisplay();
  } else if (key === 'Backspace') {
    e.preventDefault();
    deleteChar();
  } else if (key === '(' || key === ')') {
    appendToDisplay(key);
  }
});

// Initialize
updateDisplay();
</script>
</body>
</html>